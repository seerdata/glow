!function t(e,n,r){function o(s,u){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(i)return i(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return o(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"==typeof t}function i(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function u(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,i,c,a;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[t],u(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(s(n))for(i=Array.prototype.slice.call(arguments,1),a=n.slice(),r=a.length,c=0;r>c;c++)a[c].apply(this,i);return!0},r.prototype.addListener=function(t,e){var n;if(!o(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(n=u(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!o(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,i,u;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],i=n.length,r=-1,n===e||o(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(u=i;u-- >0;)if(n[u]===e||n[u].listener&&n[u].listener===e){r=u;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],o(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(o(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,n){var r;r=function(){function t(){}return t._NONCE_TAG="__nc",t._SKEY_TAG="storage_key",t._DEF_ROOT=".v1.stor.vlt12",t.RELAY_TOKEN_LEN=32,t.RELAY_TOKEN_B64=44,t.RELAY_TOKEN_TIMEOUT=3e5,t.RELAY_SESSION_TIMEOUT=9e5,t.RELAY_AJAX_TIMEOUT=5e3,t}(),e.exports=r},{}],3:[function(t,e,n){var r,o,i,s,u;r=t("config"),i=t("keys"),s=t("nacl"),u=t("utils"),o=function(){function t(){}return t.prototype._storageDriver=null,t.prototype.tag=function(t){return t&&t+this.root},t["new"]=function(e,n){var o;return null==e&&(e=null),null==n&&(n=null),o=new t,o.storageKey=e,o.root=n?"."+n+r._DEF_ROOT:r._DEF_ROOT,o.storageKey?u.resolve(o):o._loadKey().then(function(){return o.storageKey?o:o.newKey().then(function(){return o})})},t.prototype._saveKey=function(){return this._set(r._SKEY_TAG,this.storageKey.toString())},t.prototype._loadKey=function(){return this._get(r._SKEY_TAG).then(function(t){return function(e){return e?t.setKey(i.fromString(e)):void 0}}(this))},t.prototype.selfDestruct=function(t){return u.ensure(t),this._localRemove(this.tag(r._SKEY_TAG))},t.prototype.setKey=function(t){return this.storageKey=t,this._saveKey()},t.prototype.newKey=function(){return s.makeSecretKey().then(function(t){return function(e){return t.setKey(e)}}(this))},t.prototype.save=function(t,e){return u.ensure(t),e=JSON.stringify(e),s.use().encode_utf8(e).then(function(e){return function(n){return s.use().crypto_secretbox_random_nonce().then(function(o){return s.use().crypto_secretbox(n,o,e.storageKey.key).then(function(n){return e._multiSet(t,n.toBase64(),r._NONCE_TAG+"."+t,o.toBase64()).then(function(){return!0})})})}}(this))},t.prototype.get=function(t){return this._get(t).then(function(e){return function(n){return n?e._get(r._NONCE_TAG+"."+t).then(function(t){return t?s.use().crypto_secretbox_open(n.fromBase64(),t.fromBase64(),e.storageKey.key).then(function(t){return s.use().decode_utf8(t).then(function(t){return JSON.parse(t)})}):null}):null}}(this))},t.prototype.remove=function(t){return this._localRemove(this.tag(t)).then(function(e){return function(){return e._localRemove(e.tag(r._NONCE_TAG+"."+t)).then(function(){return!0})}}(this))},t.prototype._get=function(t){return this._localGet(this.tag(t))},t.prototype._set=function(t,e){return u.ensure(t),this._localSet(this.tag(t),e).then(function(){return e})},t.prototype._multiSet=function(t,e,n,r){return u.ensure(t,n),this._storage().multiSet?this._localMultiSet([this.tag(t),e,this.tag(n),r]):this._set(t,e).then(function(t){return function(){return t._set(n,r)}}(this))},t.prototype._localGet=function(t){return this._storage().get(t)},t.prototype._localSet=function(t,e){return this._storage().set(t,e)},t.prototype._localMultiSet=function(t){return this._storage().multiSet(t)},t.prototype._localRemove=function(t){return this._storage().remove(t)},t.prototype._storage=function(){return t._storageDriver},t.startStorageSystem=function(t){return u.ensure(t),this._storageDriver=t},t}(),e.exports=o},{config:2,keys:8,nacl:12,utils:16}],4:[function(t,e,n){var r,o;o=t("utils"),r=function(){function e(e,n,r){null==e&&(e=null),this.HEAP_SIZE=null!=n?n:Math.pow(2,23),this.UNLOAD_TIMEOUT=null!=r?r:15e3,this.js_nacl=e||("undefined"!=typeof nacl_factory&&null!==nacl_factory?nacl_factory:void 0)||t("js-nacl"),this.crypto_secretbox_KEYBYTES=this.use().crypto_secretbox_KEYBYTES,t("nacl").API.forEach(function(t){return function(e){return t[e]=function(){var n,r,i;i=t.use();try{return o.resolve(i[e].apply(i,arguments))}catch(r){return n=r,o.reject(n)}}}}(this))}return e.prototype._instance=null,e.prototype._unloadTimer=null,e.prototype.use=function(){return this._unloadTimer&&clearTimeout(this._unloadTimer),this._unloadTimer=setTimeout(function(t){return function(){return t.unload()}}(this),this.UNLOAD_TIMEOUT),this._instance||(this._instance=this.js_nacl.instantiate(this.HEAP_SIZE)),this._instance},e.prototype.unload=function(){return this._unloadTimer=null,this._instance=null,delete this._instance},e}(),e.exports=r,window.__CRYPTO_DEBUG&&(window.JsNaclDriver=r)},{"js-nacl":void 0,nacl:12,utils:16}],5:[function(t,e,n){var r,o;o=t("utils"),r=function(){function e(e,n,r){var i,s,u,c,a,l;null==e&&(e="/src/js_nacl_worker.js"),null==n&&(n="/node_modules/js-nacl/lib/nacl_factory.js"),null==r&&(r=Math.pow(2,23)),a={random_bytes:32,crypto_box_keypair:32,crypto_box_random_nonce:24,crypto_secretbox_random_nonce:24},s=!1,i=[],c={},l=new Worker(e),this.crypto_secretbox_KEYBYTES=32,t("nacl").API.forEach(function(t){return function(e){var n;return n=[],c[e]=n,i.push(e),t[e]=function(){var t,r,i,u,c;return i=o.promise(function(t,e){return n.push({resolve:t,reject:e})}),t=Array.prototype.slice.call(arguments),u=[],c=null,s||(r=a[e],r&&(c=new Uint8Array(32),crypto.getRandomValues(c))),l.postMessage({cmd:e,args:t,rnd:c},u),i}}}(this)),u=function(t){var e;return e=c[t.data.cmd],t.data.error?e.shift().reject(new Error(t.data.message)):e.shift().resolve(t.data.res)},l.onmessage=function(t){if("init"!==t.data.cmd)throw new Error;return s=t.data.hasCrypto,console.log("js nacl web worker initialized; hasCrypto: "+s),l.onmessage=u},l.postMessage({cmd:"init",naclPath:n,heapSize:r,api:i})}return e}(),e.exports=r,window.__CRYPTO_DEBUG&&(window.JsNaclDriver=r)},{nacl:12,utils:16}],6:[function(t,e,n){var r,o;o=t("nacl"),r=function(){function t(){}return t.prototype.lastKey=null,t.prototype.confirmedKey=null,t.prototype.nextKey=null,t.prototype._roles=["lastKey","confirmedKey","nextKey"],t["new"]=function(e,n,r){var o,i;return this.id=e,this.keyRing=n,null==r&&(r=null),Utils.ensure(this.id,this.keyRing),i=new t,o=this._roles.map(function(t){return function(t){return i.keyRing.getKey(i.keyTag(t)).then(function(e){return i[t]=e})}}(this)),Utils.all(o).then(function(t){return function(){return r?i.startRatchet(r).then(function(){return i}):i}}(this))},t.prototype.keyTag=function(t){return t+"_"+this.id},t.prototype.storeKey=function(t){return this.keyRing.saveKey(this.keyTag(t),this[t])},t.prototype.startRatchet=function(t){var e;return e=["confirmedKey","lastKey"].map(function(e){return function(n){return e[n]?void 0:(e[n]=t,e.storeKey(n))}}(this)),Utils.all(e).then(function(t){return function(){return t.nextKey?void 0:o.makeKeyPair().then(function(e){return t.nextKey=e,t.storeKey("nextKey")})}}(this))},t.prototype.pushKey=function(t){return this.lastKey=this.confirmedKey,this.confirmedKey=this.nextKey,this.nextKey=t,Utils.all(this._roles.map(function(t){return function(e){return t.storeKey(e)}}(this)))},t.prototype.confKey=function(t){return this.confirmedKey&&this.confirmedKey.equal(t)?Utils.resolve(!1):(this.lastKey=this.confirmedKey,this.confirmedKey=t,Utils.all(["lastKey","confirmedKey"].map(function(t){return function(e){return t.storeKey(e)}}(this))).then(function(){return!0}))},t.prototype.curKey=function(){return this.confirmedKey?this.confirmedKey:this.lastKey},t.prototype.h2LastKey=function(){return o.h2(this.lastKey.boxPk)},t.prototype.h2ConfirmedKey=function(){return o.h2(this.confirmedKey.boxPk)},t.prototype.h2NextKey=function(){return o.h2(this.nextKey.boxPk)},t.prototype.keyByHash=function(t){return Utils.serial(this._roles,function(e){return function(n){return o.h2(e[s].boxPk).then(function(n){return n===t?e[s]:void 0})}}(this))},t.prototype.isNextKeyHash=function(t){return this.h2NextKey().then(function(e){return e.equal(t)})},t.prototype.toStr=function(){return JSON.stringify(this).toBase64()},t.prototype.fromStr=function(t){return Utils.extend(this,JSON.parse(t.fromBase64()))},t.prototype.selfDestruct=function(t){return Utils.ensure(t),Utils.all(this._roles.map(function(t){return function(e){return t.keyRing.deleteKey(t.keyTag(e))}}(this)))},t}(),e.exports=r,window.__CRYPTO_DEBUG&&(window.KeyRatchet=r)},{nacl:12}],7:[function(t,e,n){var r,o,i,s,u,c,a,l,h=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f={}.hasOwnProperty;r=t("config"),o=t("crypto_storage"),u=t("keys"),c=t("nacl"),a=t("utils"),i=t("events").EventEmitter,l=a.ensure,s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e["new"]=function(t,n){var r,i,s;return null==n&&(n=null),i=new e,n?(r=u.fromString(n),s=o["new"](r,t).then(function(t){return function(t){return i.storage=t}}(this))):s=o["new"](null,t).then(function(t){return function(t){return i.storage=t}}(this)),s.then(function(t){return function(){return i._ensureKeys().then(function(){return i})}}(this))},e.UNIQ_TAG="__::commKey::__",e.fromBackup=function(t,n){var r,o,i;return l(n),r=JSON.parse(n),i=r[this.UNIQ_TAG],l(i),delete r[this.UNIQ_TAG],o=function(t,e){return t.then(function(){var t,n,o;return o=function(){var o;o=[];for(n in r)t=r[n],o.push(e.addGuest(n,r[n]));return o}(),a.all(o)})},e["new"](t).then(function(t){var e;return e=t.commFromSecKey(i.fromBase64()),[e,t]}).then(function(t){var e,n;return n=t[0],e=t[1],o(n,e).then(function(){return e})})},e.prototype._ensureKeys=function(){return this._loadCommKey().then(function(t){return function(){return t._loadGuestKeys()}}(this))},e.prototype._loadCommKey=function(){return this.getKey("comm_key").then(function(t){return function(e){return t.commKey=e,t.commKey?void 0:c.makeKeyPair().then(function(e){return t.commKey=e,t.saveKey("comm_key",t.commKey)})}}(this))},e.prototype.getNumberOfGuests=function(){return Object.keys(this.guestKeys||{}).length},e.prototype._loadGuestKeys=function(){return this.storage.get("guest_registry").then(function(t){return function(e){return t.guestKeys=e||{},t.guestKeyTimeouts={}}}(this))},e.prototype.commFromSeed=function(t){return c.encode_utf8(t).then(function(t){return function(e){return c.fromSeed(e).then(function(e){return t.commKey=e,t.storage.save("comm_key",t.commKey.toString())})}}(this))},e.prototype.commFromSecKey=function(t){return c.fromSecretKey(t).then(function(t){return function(e){return t.commKey=e,t.storage.save("comm_key",t.commKey.toString())}}(this))},e.prototype.tagByHpk=function(t){var e,n,r;n=this.guestKeys;for(e in n)if(f.call(n,e)&&(r=n[e],t===r.hpk))return e;return null},e.prototype.getMasterKey=function(){return this.storage.storageKey.key2str("key")},e.prototype.getPubCommKey=function(){return this.commKey.strPubKey()},e.prototype.saveKey=function(t,e){return this.storage.save(t,e.toString()).then(function(){return e})},e.prototype.getKey=function(t){return this.storage.get(t).then(function(t){return t?u.fromString(t):null})},e.prototype.deleteKey=function(t){return this.storage.remove(t)},e.prototype.addGuest=function(t,e){return l(t,e),e=e.trimLines(),this._addGuestRecord(t,e).then(function(e){return function(n){return e._saveNewGuest(t,n).then(function(){return n.hpk})}}(this))},e.prototype._addGuestRecord=function(t,e){return l(t,e),c.h2(e.fromBase64()).then(function(n){return function(r){return n.guestKeys[t]={pk:e,hpk:r.toBase64(),temp:!1}}}(this))},e.prototype._saveNewGuest=function(t,e){return l(t,e),this.storage.save("guest_registry",this.guestKeys)},e.prototype.timeToGuestExpiration=function(t){var e;return l(t),e=this.guestKeyTimeouts[t],e?Math.max(r.RELAY_SESSION_TIMEOUT-(Date.now()-e.startTime),0):0},e.prototype.addTempGuest=function(t,e){return l(t,e),e=e.trimLines(),c.h2(e.fromBase64()).then(function(n){return function(o){return n.guestKeys[t]={pk:e,hpk:o.toBase64(),temp:!0},n.guestKeyTimeouts[t]&&clearTimeout(n.guestKeyTimeouts[t].timeoutId),n.guestKeyTimeouts[t]={timeoutId:a.delay(r.RELAY_SESSION_TIMEOUT,function(){return delete n.guestKeys[t],delete n.guestKeyTimeouts[t],n.emit("tmpguesttimeout",t)}),startTime:Date.now()}}}(this))},e.prototype.removeGuest=function(t){return l(t),this.guestKeys[t]?(delete this.guestKeys[t],this.storage.save("guest_registry",this.guestKeys)):a.resolve()},e.prototype.getGuestKey=function(t){return l(t),this.guestKeys[t]?new u({boxPk:this.getGuestRecord(t).fromBase64()}):null},e.prototype.getGuestRecord=function(t){return l(t),this.guestKeys[t]?this.guestKeys[t].pk:null},e.prototype.backup=function(){var t,n,r,o;if(r={},this.getNumberOfGuests()>0){n=this.guestKeys;for(t in n)o=n[t],o.temp||(r[t]=o.pk)}return r[e.UNIQ_TAG]=this.commKey.strSecKey(),JSON.stringify(r)},e.prototype.selfDestruct=function(t){return l(t),this.storage.remove("guest_registry").then(function(e){return function(){return e.storage.remove("comm_key").then(function(){return e.storage.selfDestruct(t)})}}(this))},e}(i),e.exports=s,window.__CRYPTO_DEBUG&&(window.KeyRing=s)},{config:2,crypto_storage:3,events:1,keys:8,nacl:12,utils:16}],8:[function(t,e,n){var r,o,i={}.hasOwnProperty;o=t("utils"),r=function(){function t(t){t&&o.extend(this,t)}return t.prototype.toString=function(){return JSON.stringify(this.constructor.keys2str(this))},t.fromString=function(t){return t?this.str2keys(JSON.parse(t.trimLines())):null},t.prototype.key2str=function(t){return t&&null!=this[t]?this[t].toBase64():null},t.prototype.strPubKey=function(){return this.boxPk.toBase64()},t.prototype.strSecKey=function(){return this.boxSk.toBase64()},t.prototype.equal=function(t){return this.strPubKey()!==t.strPubKey()?!1:null!=this.boxSk!=(null!=t.boxSk)?!1:null!=this.boxSk?this.strSecKey()===t.strSecKey():!0},t.keys2str=function(e){var n,r,o;r=new t;for(n in e)i.call(e,n)&&(o=e[n],r[n]=o.toBase64());return r},t.str2keys=function(e){var n,r,o;r=new t;for(n in e)i.call(e,n)&&(o=e[n],r[n]=o.fromBase64());return r},t}(),e.exports=r,window.__CRYPTO_DEBUG&&(window.Keys=r)},{utils:16}],9:[function(t,e,n){var r,o,i,s,u,c,a=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l={}.hasOwnProperty;r=t("config"),i=t("keyring"),u=t("nacl"),c=t("utils"),o=t("events").EventEmitter,s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e["new"]=function(t,n,r){var o;return null==n&&(n=null),null==r&&(r=!0),o=new e,o.identity=t,o.sessionKeys={},o.sessionTimeout={},i["new"](o.identity,n).then(function(t){return o.keyRing=t,r?u.h2(o.keyRing.commKey.boxPk).then(function(t){return function(t){return o._hpk=t,o}}(this)):o})},e.fromSeed=function(t,e,n){return null==e&&(e=t),null==n&&(n=null),this["new"](e,n,!1).then(function(e){return function(e){return e.keyRing.commFromSeed(t).then(function(){return u.h2(e.keyRing.commKey.boxPk).then(function(t){return e._hpk=t,e})})}}(this))},e.fromSecKey=function(t,e,n){return null==n&&(n=null),this["new"](e,n,!1).then(function(e){return function(e){return e.keyRing.commFromSecKey(t).then(function(){return u.h2(e.keyRing.commKey.boxPk).then(function(t){return e._hpk=t,e})})}}(this))},e.prototype.hpk=function(){return this._hpk.toBase64()},e.prototype.getPubCommKey=function(){return this.keyRing.getPubCommKey()},e.prototype.timeToSessionExpiration=function(t){var e,n,o;return(o=this.sessionTimeout[t])?(n=Math.max(r.RELAY_SESSION_TIMEOUT-(Date.now()-o.startTime),0),e=this.keyRing.timeToGuestExpiration(t),Math.min(n,e)):0},e.prototype.createSessionKey=function(t,e){return null==e&&(e=!1),c.ensure(t),!e&&this.sessionKeys[t]?c.resolve(this.sessionKeys[t]):(this.sessionTimeout[t]&&clearTimeout(this.sessionTimeout[t].timeoutId),u.makeKeyPair().then(function(e){return function(n){return e.sessionKeys[t]=n,e.sessionTimeout[t]={timeoutId:c.delay(r.RELAY_SESSION_TIMEOUT,function(){return e._clearSession(t)}),startTime:Date.now()},n}}(this)))},e.prototype._clearSession=function(t){return this.sessionKeys[t]=null,delete this.sessionKeys[t],this.sessionTimeout[t]=null,delete this.sessionTimeout[t],this.emit("relaysessiontimeout",t)},e.prototype.isConnectedToRelay=function(t){var e;return c.ensure(t),e=t.relayId(),Boolean(this.sessionKeys[e])&&Boolean(this._gPk(e))},e.prototype.rawEncodeMessage=function(t,n,r,o){return null==o&&(o=null),c.ensure(t,n,r),e._makeNonce(o).then(function(e){return function(o){return e._parseData(t).then(function(t){return u.use().crypto_box(t,o,n,r).then(function(t){return{nonce:o.toBase64(),ctext:t.toBase64()}})})}}(this))},e.prototype.rawDecodeMessage=function(t,e,n,r){return c.ensure(t,e,n,r),u.use().crypto_box_open(e,t,n,r).then(function(t){return u.use().decode_utf8(t).then(function(t){return JSON.parse(t)})})},e.prototype.encodeMessage=function(t,e,n,r){var o,i;if(null==n&&(n=!1),null==r&&(r=null),c.ensure(t,e),!(o=this._gPk(t)))throw new Error("encodeMessage: don't know guest "+t);return i=this._getSecretKey(t,n,r),this.rawEncodeMessage(e,o,i)},e.prototype.decodeMessage=function(t,e,n,r,o){var i,s;if(null==r&&(r=!1),null==o&&(o=null),c.ensure(t,e,n),!(i=this._gPk(t)))throw new Error("decodeMessage: don't know guest "+t);return s=this._getSecretKey(t,r,o),this.rawDecodeMessage(e.fromBase64(),n.fromBase64(),i,s)},e.prototype.connectToRelay=function(t){return c.ensure(t),t.openConnection().then(function(e){return function(){return t.connectMailbox(e)}}(this))},e.prototype.sendToVia=function(t,e,n){return c.ensure(t,e,n),this.connectToRelay(e).then(function(r){return function(){return r.relaySend(t,n,e)}}(this))},e.prototype.getRelayMessages=function(t){return c.ensure(t),this.connectToRelay(t).then(function(e){return function(){return e.relayMessages(t)}}(this))},e.prototype.relayCount=function(t){return c.ensure(t),t.count(this).then(function(t){return function(t){return parseInt(t)}}(this))},e.prototype.relay_msg_status=function(t,e){return c.ensure(t),t.message_status(this,e).then(function(t){return function(t){return t}}(this))},e.prototype.relaySend=function(t,e,n){return c.ensure(n),this.encodeMessage(t,e).then(function(e){return function(r){return u.h2(e._gPk(t)).then(function(t){return n.upload(e,t,r)})}}(this))},e.prototype.relayMessages=function(t){return c.ensure(t),t.download(this).then(function(t){return function(e){return c.all(e.map(function(e){var n;return(n=t.keyRing.tagByHpk(e.from))?(e.fromTag=n,t.decodeMessage(n,e.nonce,e.data).then(function(t){return t&&(e.msg=t,delete e.data),e})):e}))}}(this))},e.prototype.relayNonceList=function(t){return c.ensure(t),c.map(t,function(t){return t.nonce})},e.prototype.relayDelete=function(t,e){return c.ensure(t,e),e["delete"](this,t)},e.prototype.clean=function(t){return c.ensure(t),this.getRelayMessages(t).then(function(e){return function(n){return e.relayDelete(e.relayNonceList(n),t)}}(this))},e.prototype.selfDestruct=function(t){return c.ensure(t),this.keyRing.selfDestruct(t)},e.prototype._gKey=function(t){return c.ensure(t),this.keyRing.getGuestKey(t)},e.prototype._gPk=function(t){var e;return c.ensure(t),null!=(e=this._gKey(t))?e.boxPk:void 0},e.prototype._gHpk=function(t){return c.ensure(t),u.h2(this._gPk(t))},e.prototype._getSecretKey=function(t,e,n){return n?this._gPk(n):e?this.sessionKeys[t].boxSk:this.keyRing.commKey.boxSk},e.prototype._parseData=function(t){return"Uint8Array"===c.type(t)?c.resolve(t):u.use().encode_utf8(JSON.stringify(t))},e._makeNonce=function(t,e){return null==t&&(t=null),null==e&&(e=Date.now()),u.use().crypto_box_random_nonce().then(function(n){var r,o,i,s,u,a,l,h,f,p;if(null==n||24!==n.length)throw new Error("RNG failed, try again?");for(i=8,o=c.itoa(parseInt(e/1e3)),t&&(r=c.itoa(t),i+=4),s=u=0,h=i;h>=0?h>u:u>h;s=h>=0?++u:--u)n[s]=0;for(s=a=0,f=o.length-1;f>=0?f>=a:a>=f;s=f>=0?++a:--a)n[8-o.length+s]=o[s];if(t)for(s=l=0,p=r.length-1;p>=0?p>=l:l>=p;s=p>=0?++l:--l)n[12-r.length+s]=r[s];return n})},e._nonceData=function(t){return c.atoi(t.subarray(8,12))},e}(o),e.exports=s,window.__CRYPTO_DEBUG&&(window.MailBox=s)},{config:2,events:1,keyring:7,nacl:12,utils:16}],10:[function(t,e,n){e.exports={Utils:t("utils"),Mixins:t("mixins"),Nacl:t("nacl"),Keys:t("keys"),SimpleStorageDriver:t("test_driver"),CryptoStorage:t("crypto_storage"),KeyRing:t("keyring"),MailBox:t("mailbox"),Relay:t("relay"),RachetBox:t("rachetbox"),Config:t("config"),JsNaclDriver:t("js_nacl_driver"),JsNaclWebWorkerDriver:t("js_nacl_worker_driver"),setNaclImpl:function(t){return this.Nacl.setNaclImpl(t)},setPromiseImpl:function(t){return this.Utils.setPromiseImpl(t)},startStorageSystem:function(t){return this.CryptoStorage.startStorageSystem(t)},setAjaxImpl:function(t){return this.Utils.setAjaxImpl(t)}},window&&(window.glow=e.exports)},{config:2,crypto_storage:3,js_nacl_driver:4,js_nacl_worker_driver:5,keyring:7,keys:8,mailbox:9,mixins:11,nacl:12,rachetbox:13,relay:14,test_driver:15,utils:16}],11:[function(t,e,n){var r,o,i,s,u;for(o=t("utils"),o.include(String,{toCodeArray:function(){var t,e,n,r;for(n=[],t=0,e=this.length;e>t;t++)r=this[t],n.push(r.charCodeAt());return n},toUTF8:function(){return unescape(encodeURIComponent(this))},fromUTF8:function(){return decodeURIComponent(escape(this))},toUint8Array:function(){return new Uint8Array(this.toUTF8().toCodeArray())},toUint8ArrayRaw:function(){return new Uint8Array(this.toCodeArray())},fromBase64:function(){return new Uint8Array(atob(this).toCodeArray())},trimLines:function(){return this.replace("\r\n","").replace("\n","").replace("\r","")}}),u=[Array,Uint8Array,Uint16Array],i=0,s=u.length;s>i;i++)r=u[i],o.include(r,{fromCharCodes:function(){var t;return function(){var e,n,r;for(r=[],e=0,n=this.length;n>e;e++)t=this[e],r.push(String.fromCharCode(t));return r}.call(this).join("")},toBase64:function(){return btoa(this.fromCharCodes())},xorWith:function(t){var e,n;return this.length!==t.length?null:new Uint8Array(function(){var r,o,i;for(i=[],n=r=0,o=this.length;o>r;n=++r)e=this[n],i.push(e^t[n]);return i}.call(this))},equal:function(t){var e,n,r,o;if(this.length!==t.length)return!1;for(e=n=0,r=this.length;r>n;e=++n)if(o=this[e],o!==t[e])return!1;return!0},sample:function(){return this.length>0?this[Math.floor(Math.random()*this.length)]:null}});o.include(Uint8Array,{concat:function(t){var e;return e=new Uint8Array(this.byteLength+t.byteLength),e.set(new Uint8Array(this),0),e.set(t,this.byteLength),e},fillWith:function(t){var e,n,r,o;for(e=n=0,r=this.length;r>n;e=++n)o=this[e],this[e]=t;return this}}),e.exports={}},{utils:16}],12:[function(t,e,n){var r,o,i,s,u;i=t("keys"),u=t("utils"),r=t("config"),o=t("js_nacl_driver"),s=function(){function t(){}return t.API=["crypto_secretbox_random_nonce","crypto_secretbox","crypto_secretbox_open","crypto_box","crypto_box_open","crypto_box_random_nonce","crypto_box_keypair","crypto_box_keypair_from_raw_sk","crypto_box_keypair_from_seed","crypto_hash_sha256","random_bytes","encode_utf8","decode_utf8","to_hex","from_hex"],t.prototype.naclImpl=null,t.setNaclImpl=function(t){return this.naclImpl=t},t.use=function(){return this.naclImpl||this.setDefaultNaclImpl(),this.naclImpl},t.setDefaultNaclImpl=function(){return this.naclImpl=new o},t.makeSecretKey=function(){return this.use().random_bytes(this.use().crypto_secretbox_KEYBYTES).then(function(t){return new i({key:t})})},t.random=function(t){return null==t&&(t=32),this.use().random_bytes(t)},t.makeKeyPair=function(){return this.use().crypto_box_keypair().then(function(t){return new i(t)})},t.fromSecretKey=function(t){return this.use().crypto_box_keypair_from_raw_sk(t).then(function(t){return new i(t)})},t.fromSeed=function(t){return this.use().crypto_box_keypair_from_seed(t).then(function(t){return new i(t)})},t.sha256=function(t){return this.use().crypto_hash_sha256(t)},t.to_hex=function(t){return this.use().to_hex(t)},t.from_hex=function(t){return this.use().from_hex(t)},t.encode_utf8=function(t){return this.use().encode_utf8(t)},t.decode_utf8=function(t){return this.use().decode_utf8(t)},t.h2=function(t){var e;return"String"===u.type(t)&&(t=t.toUint8ArrayRaw()),e=new Uint8Array(32+t.length),e.fillWith(0),e.set(t,32),this.sha256(e).then(function(t){return function(e){return t.sha256(e)}}(this))},t.h2_64=function(e){return t.h2(e.fromBase64()).then(function(t){return t.toBase64()})},t}(),e.exports=s,window.__CRYPTO_DEBUG&&(window.Nacl=s)},{config:2,js_nacl_driver:4,keys:8,utils:16}],13:[function(t,e,n){var r,o,i,s,u,c,a,l=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},h={}.hasOwnProperty;a=t("utils"),u=t("nacl"),i=t("keys"),o=t("keyring"),r=t("keyratchet"),s=t("mailbox"),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype._loadRatchets=function(t){return this._gHpk(t).then(function(e){return function(n){return n=n.toBase64(),r["new"]("local_"+n+"_for_"+e.hpk().toBase64(),e.keyRing,e.keyRing.commKey).then(function(o){return e.krLocal=o,r["new"]("guest_"+n+"_for_"+e.hpk().toBase64(),e.keyRing,e.keyRing.getGuestKey(t)).then(function(t){return e.krGuest=t})})}}(this))},e.prototype.relaySend=function(t,e,n){return a.ensure(t,e,n),this._loadRatchets(e).then(function(r){return function(){var o,i;return o={org_msg:n},n.got_key||(o.nextKey=r.krLocal.nextKey.strPubKey()),i=r.krGuest[n.got_key?"lastKey":"confirmedKey"].boxPk,r.rawEncodeMessage(o,i,r.krLocal.confirmedKey.boxSk).then(function(n){return u.h2(r._gPk(e)).then(function(e){return t.upload(r,e,n)})})}}(this))},e.prototype._tryKeypair=function(t,e,n,r){var o,i;try{return this.rawDecodeMessage(t.fromBase64(),e.fromBase64(),n,r)}catch(i){return o=i,a.resolve(null)}},e.prototype.decodeMessage=function(t,n,r,o,i){return null==o&&(o=!1),null==i&&(i=null),o?e.__super__.decodeMessage.call(this,t,n,r,o,i):(a.ensure(t,n,r),this._loadRatchets(t).then(function(t){return function(){var e;return e=[[t.krGuest.confirmedKey.boxPk,t.krLocal.confirmedKey.boxSk],[t.krGuest.lastKey.boxPk,t.krLocal.lastKey.boxSk],[t.krGuest.confirmedKey.boxPk,t.krLocal.lastKey.boxSk],[t.krGuest.lastKey.boxPk,t.krLocal.confirmedKey.boxSk]],a.serial(e,function(e){return t._tryKeypair(n,r,e[0],e[1])}).then(function(t){return t||console.log("RatchetBox decryption failed: message from unknown guest or ratchet out of sync"),t})}}(this)))},e.prototype.relayMessages=function(){return e.__super__.relayMessages.call(this).then(function(t){return function(e){var n,r;return n=[],r=e.map(function(e){return e.fromTag?(t._loadRatchets(e.fromTag).then(function(){var r,o,s;return(null!=(s=e.msg)?s.nextKey:void 0)&&(o=new i({boxPk:e.msg.nextKey.fromBase64()}),r=t.krGuest.confKey(o).then(function(t){return t?u.h2_64(e.msg.nextKey).then(function(t){return n.push({toTag:e.fromTag,key:e.msg.nextKey,msg:{got_key:t}})}):void 0})),(r||a.resolve()).then(function(){var n,r,o;return(null!=(r=e.msg)&&null!=(o=r.org_msg)?o.got_key:void 0)&&(e.msg=e.msg.org_msg,n=t.krLocal.isNextKeyHash(e.msg.got_key.fromBase64()).then(function(e){return e?u.makeKeyPair().then(function(e){return t.krLocal.pushKey(e)}):void 0}).then(function(){return e.msg=null})),(n||a.resolve()).then(function(){return e.msg?e.msg=e.msg.org_msg:void 0})})}),a.all(r).then(function(){return a.serial(n,function(e){return t.relaySend(e.toTag,e.msg).then(function(){return!1})})})):void 0})}}(this))},e.prototype.selfDestruct=function(t,n){return null==n&&(n=!1),t&&n?a.all(this.keyRing.registry.map(function(t){return function(e){return t._loadRatchets(e).then(function(){return t.krLocal.selfDestruct(n).then(function(){return t.krGuest.selfDestruct(n)})})}}(this))).then(function(n){return function(){return e.__super__.selfDestruct.call(n,t)}}(this)):void 0},e}(s),e.exports=c,window.__CRYPTO_DEBUG&&(window.RatchetBox=c)},{keyratchet:6,keyring:7,keys:8,mailbox:9,nacl:12,utils:16}],14:[function(t,e,n){var r,o,i,s,u,c,a=function(t,e){return function(){return t.apply(e,arguments)}},l=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},h={}.hasOwnProperty,f=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};r=t("config"),i=t("keys"),s=t("nacl"),c=t("utils"),o=t("events").EventEmitter,u=function(t){function e(t){this.url=null!=t?t:null,this._ajax=a(this._ajax,this),this._resetState(),this.RELAY_COMMANDS=["count","upload","download","message_status","delete"]}return l(e,t),e.prototype.openConnection=function(){
return this.getServerToken().then(function(t){return function(){return t.getServerKey()}}(this))},e.prototype.getServerToken=function(){var t;return c.ensure(this.url),this.clientToken||(t=s.random(r.RELAY_TOKEN_LEN).then(function(t){return function(e){return t.clientToken=e}}(this))),t=(t||c.resolve()).then(function(t){return function(){if(t.clientToken&&t.clientToken.length!==r.RELAY_TOKEN_LEN)throw new Error("Token must be "+r.RELAY_TOKEN_LEN+" bytes");return t.clientTokenExpiration&&clearTimeout(t.clientTokenExpiration),t._ajax("start_session",t.clientToken.toBase64()).then(function(e){var n;return t._scheduleExpireSession(),n=t._processData(e),t.relayToken=n[0].fromBase64(),t.diff=2===n.length?parseInt(n[1]):0,t.diff>4&&console.log("Relay "+t.url+" requested difficulty "+t.diff+". Session handshake may take longer."),t.diff>16?console.log("Attempting handshake at difficulty "+t.diff+"! This may take a while"):void 0})}}(this))},e.prototype.getServerKey=function(){return c.ensure(this.url,this.clientToken,this.relayToken),s.h2(this.clientToken).then(function(t){return function(e){var n,r,o;return t.h2ClientToken=e.toBase64(),r=t.clientToken.concat(t.relayToken),0===t.diff?o=s.h2(r).then(function(t){return t.toBase64()}):(n=function(){return s.random(32).then(function(e){return s.h2(r.concat(e)).then(function(r){return c.arrayZeroBits(r,t.diff)?e:n()})})},o=n().then(function(t){return t.toBase64()})),o.then(function(e){return t._ajax("verify_session",t.h2ClientToken+"\r\n"+e+"\r\n").then(function(e){var n;return n=e.fromBase64(),t.relayKey=new i({boxPk:n}),t.online=!0})})}}(this))},e.prototype.relayId=function(){return c.ensure(this.url),"relay_"+this.url},e.prototype.connectMailbox=function(t){var e,n;return c.ensure(t,this.online,this.relayKey,this.url),n=this.relayId(),e=t.createSessionKey(n,!0).then(function(r){return function(o){var i,u;return e=o.boxPk,t.keyRing.addTempGuest(n,r.relayKey.strPubKey()),delete r.relayKey,i=e.toBase64(),u=e.concat(r.relayToken).concat(r.clientToken),s.h2(u).then(function(e){return t.encodeMessage(n,e).then(function(e){return e.pub_key=t.keyRing.getPubCommKey(),t.encodeMessage(n,e,!0).then(function(t){return r._ajax("prove",r.h2ClientToken+"\r\n"+(i+"\r\n")+(t.nonce+"\r\n")+(""+t.ctext)).then(function(t){return n})})})})}}(this))},e.prototype.runCmd=function(t,e,n){var r;if(null==n&&(n=null),c.ensure(t,e),f.call(this.RELAY_COMMANDS,t)<0)throw new Error("Relay "+this.url+" doesn't support "+t);return r={cmd:t},n&&(r=c.extend(r,n)),e.encodeMessage("relay_"+this.url,r,!0).then(function(r){return function(o){return r._ajax("command",e._hpk.toBase64()+"\r\n"+(o.nonce+"\r\n")+(""+o.ctext)).then(function(o){if(null==o)throw new Error(r.url+" - "+t+" error");return"count"===t||"upload"===t||"download"===t||"message_status"===t?r._processResponse(o,e,t,n):JSON.parse(o)})}}(this))},e.prototype._processResponse=function(t,e,n,o){var i,s,u;if(s=this._processData(String(t)),"upload"===n){if(1!==s.length||s[0].length!==r.RELAY_TOKEN_B64)throw new Error(this.url+" - "+n+": Bad response");return o.storage_token=t,o}if("message_status"===n){if(1!==s.length)throw new Error(this.url+" - "+n+": Bad response");return parseInt(s[0])}if(2!==s.length)throw new Error(this.url+" - "+n+": Bad response");return u=s[0],i=s[1],e.decodeMessage("relay_"+this.url,u,i,!0)},e.prototype._processData=function(t){var e;return e=t.split("\r\n"),e.length>=2||(e=t.split("\n")),e},e.prototype.count=function(t){return this.runCmd("count",t)},e.prototype.upload=function(t,e,n){return this.runCmd("upload",t,{to:e.toBase64(),payload:n})},e.prototype.message_status=function(t,e){return this.runCmd("message_status",t,{token:e})},e.prototype.download=function(t){return this.runCmd("download",t)},e.prototype["delete"]=function(t,e){return this.runCmd("delete",t,{payload:e})},e.prototype._resetState=function(){return this.clientToken=null,this.online=!1,this.relayToken=null,this.relayKey=null,this.clientTokenExpiration=null,this.clientTokenExpirationStart=0},e.prototype.timeToTokenExpiration=function(){return Math.max(r.RELAY_TOKEN_TIMEOUT-(Date.now()-this.clientTokenExpirationStart),0)},e.prototype.timeToSessionExpiration=function(t){return t.timeToSessionExpiration("relay_"+this.url)},e.prototype._scheduleExpireSession=function(){return this.clientTokenExpiration&&clearTimeout(this.clientTokenExpiration),this.clientTokenExpirationStart=Date.now(),this.clientTokenExpiration=setTimeout(function(t){return function(){return t._resetState(),t.emit("relaytokentimeout")}}(this),r.RELAY_TOKEN_TIMEOUT)},e.prototype._ajax=function(t,e){return c.ajax(this.url+"/"+t,e)},e}(o),e.exports=u,window.__CRYPTO_DEBUG&&(window.Relay=u)},{config:2,events:1,keys:8,nacl:12,utils:16}],15:[function(t,e,n){var r,o;o=t("utils"),r=function(){function t(t,e){null==t&&(t="storage."),null==e&&(e=null),this._root_tag="__glow."+t,this._load(e)}return t.prototype._state=null,t.prototype._key_tag=function(t){return this._root_tag+"."+t},t.prototype.get=function(t){var e;return this._state||this._load(),e=this._state[t]?this._state[t]:JSON.parse(localStorage.getItem(this._key_tag(t))),o.resolve(e)},t.prototype.set=function(t,e){return this._state||this._load(),this._state[t]=e,localStorage.setItem(this._key_tag(t),JSON.stringify(e)),this._persist()},t.prototype.multiSet=function(t){var e,n,r,o;for(this._state||this._load(),e=n=0,o=t.length;o>n;e=n+=2)r=t[e],localStorage.setItem(this._key_tag(r),JSON.stringify(t[e+1]));return this._persist()},t.prototype.remove=function(t){return this._state||this._load(),delete this._state[t],localStorage.removeItem(this._key_tag(t)),this._persist()},t.prototype._persist=function(){return o.resolve()},t.prototype._load=function(t){return null==t&&(t=null),this._state=t?t:{},console.log("INFO: SimpleTestDriver uses localStorage and should not be used in production for permanent key storage.")},t}(),e.exports=r},{utils:16}],16:[function(t,e,n){var r,o;r=t("config"),o=function(){function t(){}return t.extend=function(t,e){var n,r;if("undefined"!=typeof $&&null!==$?$.extend:void 0)return $.extend(t,e);for(n in e)r=e[n],void 0!==e[n]&&(t[n]=e[n]);return t},t.map=function(t,e){return("undefined"!=typeof $&&null!==$?$.map:void 0)?"undefined"!=typeof $&&null!==$?$.map(t,e):void 0:Array.prototype.map.apply(t,[e])},t.include=function(t,e){return this.extend(t.prototype,e)},t.type=function(t){return void 0===t?"undefined":null===t?"null":Object.prototype.toString.call(t).replace("[","").replace("]","").split(" ")[1]},t.ajaxImpl=null,t.setAjaxImpl=function(t){return this.ajaxImpl=t},t.ajax=function(t,e){return this.ajaxImpl||this.setDefaultAjaxImpl(),this.ajaxImpl(t,e)},t.setDefaultAjaxImpl=function(){if("undefined"!=typeof axios&&null!==axios)return this.setAjaxImpl(function(t,e){return axios({url:t,method:"post",headers:{Accept:"text/plain","Content-Type":"text/plain"},data:e,responseType:"text",timeout:r.RELAY_AJAX_TIMEOUT}).then(function(t){return t.data})});if("undefined"!=typeof Q&&null!==Q?Q.xhr:void 0)return this.setAjaxImpl(function(t,e){return Q.xhr({method:"POST",url:t,headers:{Accept:"text/plain","Content-Type":"text/plain"},data:e,responseType:"text",timeout:r.RELAY_AJAX_TIMEOUT,disableUploadProgress:!0}).then(function(t){return t.data})});if(("undefined"!=typeof $&&null!==$?$.ajax:void 0)&&("undefined"!=typeof $&&null!==$?$.Deferred:void 0))return this.setAjaxImpl(function(t,e){return $.ajax({url:t,type:"POST",dataType:"text",timeout:r.RELAY_AJAX_TIMEOUT,context:this,error:console.log,contentType:"text/plain",data:e})});throw new Error("Unable to set default Ajax implementation.")},t.promiseImpl=null,t.setPromiseImpl=function(t){return this.promiseImpl=t},t.getPromiseImpl=function(){return this.promiseImpl||this.setDefaultPromiseImpl(),this.promiseImpl},t.setDefaultPromiseImpl=function(){if("undefined"!=typeof Promise&&null!==Promise)return this.setPromiseImpl({promise:function(t){return new Promise(t)},all:function(t){return Promise.all(t)}});if("undefined"!=typeof Q&&null!==Q)return this.setPromiseImpl({promise:function(t){return Q.promise(t)},all:function(t){return Q.all(t)}});throw new Error("Unable to set default Promise implementation.")},t.delay=function(t,e){return setTimeout(e,t)},t.itoa=function(t){var e,n,r,o,i,s;return 0>=t?new Uint8Array(function(){var t,e;for(e=[],n=t=0;7>=t;n=++t)e.push(0);return e}()):(i=[Math.floor,Math.pow,Math.log],e=i[0],o=i[1],r=i[2],s=e(r(t)/r(256)),new Uint8Array(function(){var r,i,u;for(u=[],n=r=i=s;0>=i?0>=r:r>=0;n=0>=i?++r:--r)u.push(e(t/o(256,n))%256);return u}()))},t.atoi=function(t){var e,n,r,o,i,s;for(r=t.length-1,i=0,e=n=0,o=t.length;o>n;e=++n)s=t[e],i+=s*Math.pow(256,r-e);return i},t.firstZeroBits=function(t,e){return t===t>>e<<e},t.arrayZeroBits=function(t,e){var n,r,o,i,s;for(s=e,r=o=0,i=1+e/8;i>=0?i>=o:o>=i;r=i>=0?++o:--o){if(n=t[r],0>=s)return!0;if(!(s>8))return this.firstZeroBits(n,s);if(s-=8,n>0)return!1}return!1},t.logStack=function(t){var e,n,r,o,i,s;for(t||(t=new Error("stackLog")),i=t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@").split("\n"),o=[],e=n=0,r=i.length;r>n;e=++n)s=i[e],o.push(console.log(e+": "+s));return o},t.resolve=function(t){return this.getPromiseImpl().promise(function(e,n){return e(t)})},t.reject=function(t){return this.getPromiseImpl().promise(function(e,n){return n(t)})},t.promise=function(t){return this.getPromiseImpl().promise(t)},t.all=function(t){return this.getPromiseImpl().all(t)},t.serial=function(t,e){var n,r;return n=0,(r=function(o){return function(o){return e(o).then(function(e){return e?e:n<t.length?r(t[++n]):void 0})}}(this))(t[++n])},t.incrementByteCounter=function(t){var e,n,r;for(n=r=t.length-1;r>=0;n=r+=-1){if(e=t[n],255!==e)return void t[n]++;t[n]=0}},t.ENSURE_ERROR_MSG="invalid arguments",t.ensure=function(){var e,n,r,o;for(o=[],n=0,r=arguments.length;r>n;n++){if(e=arguments[n],!e)throw new Error(t.ENSURE_ERROR_MSG);o.push(void 0)}return o},t}(),e.exports=o,window.__CRYPTO_DEBUG&&(window.Utils=o)},{config:2}]},{},[10]);